CREATE DATABASE RecipesExample
GO

USE RecipesExample
GO

CREATE TABLE Ingredient_Classes (
	IngredientClassID smallint NOT NULL ,
	IngredientClassDescription nvarchar (255) NULL 
)
GO

CREATE TABLE Ingredients (
	IngredientID int NOT NULL ,
	IngredientName nvarchar (255) NULL ,
	IngredientClassID smallint NULL ,
	MeasureAmountID smallint NULL 
)
GO

CREATE TABLE Measurements (
	MeasureAmountID smallint NOT NULL ,
	MeasurementDescription nvarchar (255) NULL 
)
GO

CREATE TABLE Recipe_Classes (
	RecipeClassID smallint NOT NULL ,
	RecipeClassDescription nvarchar (255) NULL 
)
GO

CREATE TABLE Recipe_Ingredients (
	RecipeID int NOT NULL ,
	RecipeSeqNo smallint NOT NULL ,
	IngredientID int NULL ,
	MeasureAmountID smallint NULL ,
	Amount real NULL ,
)
GO

CREATE TABLE Recipes (
	RecipeID int NOT NULL ,
	RecipeTitle nvarchar (255) NULL ,
	RecipeClassID smallint NULL ,
	Preparation ntext NULL ,
	Notes ntext NULL ,
) 
GO

ALTER TABLE Ingredient_Classes ADD 
	CONSTRAINT Ingredient_Class_ID_Default DEFAULT (0) FOR IngredientClassID,
	CONSTRAINT Ingredient_Classes_PK PRIMARY KEY   
	(
		IngredientClassID
	)  
GO

ALTER TABLE Ingredients ADD 
	CONSTRAINT Ingredient_ID_Default DEFAULT (0) FOR IngredientID,
	CONSTRAINT IN_Ingredient_Class_ID_Default DEFAULT (0) FOR IngredientClassID,
	CONSTRAINT IN_Measure_Amount_ID_Default DEFAULT (0) FOR MeasureAmountID,
	CONSTRAINT Ingredients_PK PRIMARY KEY   
	(
		IngredientID
	)  
GO

 CREATE  INDEX Ingredient_ClassesIngredients ON Ingredients(IngredientClassID)
GO

 CREATE  INDEX MeasurementsIngredients ON Ingredients(MeasureAmountID)
GO

ALTER TABLE Measurements ADD 
	CONSTRAINT Measure_ID_Default DEFAULT (0) FOR MeasureAmountID,
	CONSTRAINT Measurements_PK PRIMARY KEY   
	(
		MeasureAmountID
	)  
GO

ALTER TABLE Recipe_Classes ADD 
	CONSTRAINT Recipe_Class_ID_Default DEFAULT (0) FOR RecipeClassID,
	CONSTRAINT Recipe_Classes_PK PRIMARY KEY   
	(
		RecipeClassID
	)  
GO

ALTER TABLE Recipe_Ingredients ADD 
	CONSTRAINT RI_Recipe_ID_Default DEFAULT (0) FOR RecipeID,
	CONSTRAINT Recipe_Seq_No_Default DEFAULT (0) FOR RecipeSeqNo,
	CONSTRAINT RI_Ingredient_ID_Default DEFAULT (0) FOR IngredientID,
	CONSTRAINT RI_Measure_Amount_ID_Default DEFAULT (0) FOR MeasureAmountID,
	CONSTRAINT Amount_Default DEFAULT (0) FOR Amount,
	CONSTRAINT Recipe_Ingredients_PK PRIMARY KEY   
	(
		RecipeID,
		RecipeSeqNo
	)  
GO

 CREATE  INDEX IngredientID ON Recipe_Ingredients(IngredientID)
GO

 CREATE  INDEX MeasureAmountID ON Recipe_Ingredients(MeasureAmountID)
GO

 CREATE  INDEX RecipeID ON Recipe_Ingredients(RecipeID)
GO

ALTER TABLE Recipes ADD 
	CONSTRAINT Recipe_ID_Default DEFAULT (0) FOR RecipeID,
	CONSTRAINT R_Recipe_Class_ID_Default DEFAULT (0) FOR RecipeClassID,
	CONSTRAINT Recipes_PK PRIMARY KEY   
	(
		RecipeID
	)  
GO

 CREATE  INDEX Recipe_ClassesRecipes ON Recipes(RecipeClassID)
GO

ALTER TABLE Ingredients ADD 
	CONSTRAINT Ingredients_FK00 FOREIGN KEY 
	(
		IngredientClassID
	) REFERENCES Ingredient_Classes (
		IngredientClassID
	) ON UPDATE CASCADE ,
	CONSTRAINT Ingredients_FK01 FOREIGN KEY 
	(
		MeasureAmountID
	) REFERENCES Measurements (
		MeasureAmountID
	) ON UPDATE CASCADE
GO

ALTER TABLE Recipes ADD 
	CONSTRAINT Recipes_FK00 FOREIGN KEY 
	(
		RecipeClassID
	) REFERENCES Recipe_Classes (
		RecipeClassID
	) ON UPDATE CASCADE 
GO

ALTER Table Recipe_Ingredients ADD
	CONSTRAINT Recipe_Ingredients_FK00 FOREIGN KEY
	(
		RecipeID
	) REFERENCES Recipes (
		RecipeID
	),
	CONSTRAINT Recipe_Ingredients_FK01 FOREIGN KEY
	(
		IngredientID
	) REFERENCES Ingredients (
		IngredientID
	),
	CONSTRAINT Recipe_Ingredients_FK02 FOREIGN KEY
	(
		MeasureAmountID
	) REFERENCES Measurements (
		MeasureAmountID
	)
GO

USE RecipesExample;
INSERT INTO Ingredient_Classes
  VALUES (1, 'Spice');
INSERT INTO Ingredient_Classes
  VALUES (2, 'Meat');
INSERT INTO Ingredient_Classes
  VALUES (3, 'Vegetable');
INSERT INTO Ingredient_Classes
  VALUES (4, 'Oil');
INSERT INTO Ingredient_Classes
  VALUES (5, 'Pasta');
INSERT INTO Ingredient_Classes
  VALUES (6, 'Grain');
INSERT INTO Ingredient_Classes
  VALUES (7, 'Flour');
INSERT INTO Ingredient_Classes
  VALUES (8, 'Dairy');
INSERT INTO Ingredient_Classes
  VALUES (9, 'Liquid');
INSERT INTO Ingredient_Classes
  VALUES (10, 'Seafood');
INSERT INTO Ingredient_Classes
  VALUES (11, 'Butter');
INSERT INTO Ingredient_Classes
  VALUES (12, 'Cheese');
INSERT INTO Ingredient_Classes
  VALUES (13, 'Sauce');
INSERT INTO Ingredient_Classes
  VALUES (14, 'Dressing');
INSERT INTO Ingredient_Classes
  VALUES (15, 'Gravy');
INSERT INTO Ingredient_Classes
  VALUES (16, 'Topping');
INSERT INTO Ingredient_Classes
  VALUES (17, 'Fruit');
INSERT INTO Ingredient_Classes
  VALUES (18, 'Chips');
INSERT INTO Ingredient_Classes
  VALUES (19, 'Condiment');
INSERT INTO Ingredient_Classes
  VALUES (20, 'Bottle');
INSERT INTO Ingredient_Classes
  VALUES (21, 'Packaged food');
INSERT INTO Ingredient_Classes
  VALUES (22, 'Herb');
INSERT INTO Ingredient_Classes
  VALUES (23, 'Sorbet');
INSERT INTO Ingredient_Classes
  VALUES (24, 'Liquor');
 
INSERT INTO Measurements
  VALUES (1, 'Ounce');
INSERT INTO Measurements
  VALUES (2, 'Cup');
INSERT INTO Measurements
  VALUES (3, 'Teaspoon');
INSERT INTO Measurements
  VALUES (4, 'Tablespoon');
INSERT INTO Measurements
  VALUES (5, 'Pound');
INSERT INTO Measurements
  VALUES (6, 'Pinch');
INSERT INTO Measurements
  VALUES (7, 'Piece');
INSERT INTO Measurements
  VALUES (8, 'Slice');
INSERT INTO Measurements
  VALUES (9, 'Dash');
INSERT INTO Measurements
  VALUES (10, 'Can');
INSERT INTO Measurements
  VALUES (11, 'Bag');
INSERT INTO Measurements
  VALUES (12, 'Bottle');
INSERT INTO Measurements
  VALUES (13, 'Head');
INSERT INTO Measurements
  VALUES (14, 'Bunch');
INSERT INTO Measurements
  VALUES (15, 'Ear');
INSERT INTO Measurements
  VALUES (16, 'Clove');
INSERT INTO Measurements
  VALUES (17, 'Whole');
INSERT INTO Measurements
  VALUES (18, 'Pint');
INSERT INTO Measurements
  VALUES (19, 'To Taste');
INSERT INTO Measurements
  VALUES (20, 'Package');
INSERT INTO Measurements
  VALUES (21, 'Jar');
INSERT INTO Measurements
  VALUES (22, 'Sprig');
INSERT INTO Measurements
  VALUES (23, 'Quarts');
INSERT INTO Measurements
  VALUES (24, 'sticks');
INSERT INTO Measurements
  VALUES (25, 'filets');
INSERT INTO Measurements
  VALUES (26, 'Scoop');
 
INSERT INTO Recipe_Classes
  VALUES (1, 'Main course');
INSERT INTO Recipe_Classes
  VALUES (2, 'Vegetable');
INSERT INTO Recipe_Classes
  VALUES (3, 'Starch');
INSERT INTO Recipe_Classes
  VALUES (4, 'Salad');
INSERT INTO Recipe_Classes
  VALUES (5, 'Hors d''oeuvres');
INSERT INTO Recipe_Classes
  VALUES (6, 'Dessert');
INSERT INTO Recipe_Classes
  VALUES (7, 'Soup');
 
INSERT INTO Recipes
  VALUES (1, 'Irish Stew', 1, 'Cut the beef into 1" chunks
Braise the meat
Add water and Guinness
Chop onions, potatoes, and carrots into 1/2" chunks.
Add to stew.
Simmer until vegetables are done.', 
   NULL);
INSERT INTO Recipes
  VALUES (2, 'Salsa Buena', 5, 'Coarsely dice the jalapenos .
Mix all ingredients thoroughly in a bowl and let stand in the refrigerator for about an hour. 
Serve with your favorite corn chips.', 
   NULL);
INSERT INTO Recipes
  VALUES (3, 'Machos Nachos', 5, 'Slice the jalapenos crosswise (in circles) and set aside.
Grate the cheddar cheese and set aside.
Dice the onion and set aside.
Spread the tortilla chips on a large microwavable dish.
Top the chips with the grated cheese, diced onion, and jalapenos.
Place the dish in the micowave and cook until the cheese just melts, about 3-4 minutes on high.
When the cheese has melted, remove the dish and top with the black olives.', 
   'You can add a half a cup of diced tomatoes to this dish if you like. You can either add them prior to cooking in the microwave or afterwards, just before you add the black olives.');
INSERT INTO Recipes
  VALUES (4, 'Garlic Green Beans', 2, 'Snap off and discard the ends of the beans, then rinse them in cold water.
Mince the two cloves of garlic.
Heat the oil in a frying pan on medium high heat.
When the oil is hot, add the green beans and garlic. 
Stir contiuously for about four minutes. 
Place the beans on a serving dish when they''re done and sprinkle silvered almonds on the top.', 
   'Be sure not to burn the oil. Watch it carefully while it''s heating.');
INSERT INTO Recipes
  VALUES (5, 'Fettuccini Alfredo', 1, 'Fill a large pot two thirds full with water. Add one tablespoon each of salt and vegetable oil. Bring to a rollling boil.
Reduce heat, add pasta, and stir briefly. Cook until pasta is al dente.
Just before the pasta is ready (about five minutes), melt the butter in a frying pan on low heat.
After the butter has melted, add the heavy cream to the pan. Increase the heat to medium and stir until the mixture is slightly thickened. Remove the pan from the heat once the mixture is ready.
Drain the fettuccini when it''s done and add it to the mixture in the frying pan.
Mix three ounces of the cheese the the fettuccini and toss the entire mixture.
Add another three ounces of cheese and the white pepper, and toss again lightly.', 
   NULL);
INSERT INTO Recipes
  VALUES (6, 'Pollo Picoso', 1, 'Wash chicken pieces thoroughly in cold water. Pat dry and set aside.
Mince garlic and then mix it with the salt, pepper, and cayenne. Make sure the mixture is combined as thoroughly as possible.
Coat each chicken piece (to taste) with the mixture. 
Place pieces in the broiler pan and cook for 15 minutes. Turn pieces and cook for another 15 minutes. Turn pieces once more and cook for 35 - 40 minutes.
When the chicken is cooked, remove from stove and let it stand for 10 minutes.', 
   'Pre-heat the oven to 400 degrees.
Cover the bottom of a broiler pan with a sheet of aluminum foil and then pour in about 1/2 an inch of water. The water will keep the chicken grease drippings from splattering throughout the inside of the stove and causing smoke. The foil makes the pan easier to clean.');
INSERT INTO Recipes
  VALUES (7, 'Mike''s Summer Salad', 4, 'Rinse lettuce and cut into bite size pieces. (You can tear them if you really want to.)
Dust off mushrooms, remove stems, and slice into thick pieces, about 1/4".
Peel the cucumber and slice it into 1/4" thick circles.
Slice the tomatoes into 1/2" wedges.
Wash radishes, remove leafy head and root, and slice into 1/8" circles.
Mix all ingredients together in a large salad bowl and add your favorite balsamic vinaigrette dressing.', 
   NULL);
INSERT INTO Recipes
  VALUES (8, 'Trifle', 6, 'Prepare the Jello and custard per package directions.
In tall dessert cups, place a 1/2" layer of the sponge cake.  Soak the layer of cake in Jello.  Spoon on a thin layer of raspberry jam.  Add a layer of custard.
Continue adding layers of sponge cake, jam, and custard until the cup is full (with a layer of custard on top) -- 2 to 3 layers.
Chill for 2 hours.  Sprinkle colored sugar on top and serve.', 
   'For a "spicier" dessert, replace half the liquid in the Jello with brandy or your favorite liqueur.');
INSERT INTO Recipes
  VALUES (9, 'Roast Beef', 1, 'Place the beef on a roasting rack in a roasting pan.
Make a paste of ground garlic, salt, and pepper.  Smother the outside of the roast with the paste.
Roast at 325 for about 20 minutes per pound or to an internal temperature of 160F for medium-rare.
Remove from oven and let stand 15 minutes before carving.  Reserve the beef drippings for gravy or Yorkshire Pudding.', 
   NULL);
INSERT INTO Recipes
  VALUES (10, 'Yorkshire Pudding', 3, 'Place the eggs and water in a blender.  While running the blender, slowly add the flour.  Add the salt and milk and blend for 30 seconds more.
Let stand in a refrigerator for 1 hour or more.
Heat the roasting pan with beef drippings to 450F.  Pour in the pudding mixture.  Cook in a very hot oven for 20-25 minutes or until puffed up and golden brown.  Remove from the pan immediately and cut into slices.  Serve with brown gravy.', 
   NULL);
INSERT INTO Recipes
  VALUES (11, 'Huachinango Veracruzana (Red Snapper, Veracruz style)', 
   1, 'Heat one ounce of olive oil in a 1.5 quart saucepan.  Slice the onion and sautee lightly in the olive oil.
Drain the canned tomatoes (you can use peeled fresh tomatoes if you like) and puree in a blender.
To the pureed tomatoes, add all the spices, thinly sliced Jalapenos, and green olives.  Pour the tomato and spice mixture into the saucepan with the onions and simmer on a very low heat covered for 30 minutes.
While the sauce is cooking, peel and boil the potatoes.
Just before the potatoes are done, heat the remaining olive oil in a large frypan.  Wash and lightly dust the fish pieces in a mixture of flour, salt, and pepper.  Fry the fish, turning once, until just done.
Place the cooked fish in a large platter.  Surround the fish with the boiled potatoes.  Pour the sauce over the fish, sprinkle with chopped parsley, and serve immediately.
Serves 6.', 
   'You can substitute any firm white fish filets for the Red Snapper.  If you use salted canned tomatoes, reduce the salt in the sauce by half.  Adjust the amount of the Jalapenos in the sauce to suit your taste for spicy food!');
INSERT INTO Recipes
  VALUES (12, 'Asparagus', 2, 'Wash the asparagus and break off the tough part (if any) at the bottom of the stalks.  Arrange on a steaming rack in a large saucepan.  Dab liberally with pats of butter and sprinkle on the chopped garlic.  Steam until just tender -- no more than 5 minutes for large stalks.  Serve immediately.', 
   'You can chill the cooked asparagus and serve with your favorite dip as an appetizer.');
INSERT INTO Recipes
  VALUES (13, 'Tourtière (French-Canadian Pork Pie)', 
   1, 'Brown ground pork and chopped onion, stirring and breaking up pork.  Add spices and salt and pepper.  Simmer, uncovered, for 45 minutes, stirring occasionally.  Preheat oven to 375 degrees.  Prepare pie dough for 2-crust pie.  Line 9" pie plate with half of the rolled-out dough.  Drain pork and stir bread crumbs into pork.  Taste and add more salt and pepper if desired.  Fill pie with pork mixture and top with second half of the rolled-out dough.  Crimp edges of pie and slit the top in several places.  Bake in 375-degree oven for one hour, covering edges of pie crust with foil if necessary.  Serve hot or cold.', 
   'Be sure to use fresh ground pork, not sausage.  Can be made with half ground pork and half ground beef, if desired.');
INSERT INTO Recipes
  VALUES (14, 'Salmon Filets in Parchment Paper', 1, 
   'Julienne carrots, leeks, and bell peppers and steam for several minutes.  Drain and rinse vegetables in ice water and set aside.  Preheat oven to 400 degrees.  Butter 4 large rounds of parchment paper.  Distribute half of vegetables on one side of each round of parchment.  Place a salmon filet on the vegetables on each round.  Top the filets with the rest of the vegetables.  Combine white wine and lemon juice and spoon 1 tablespoon on each filet.  Pour melted butter on filets.  Place a thinly-sliced lemon round on each.  Salt and pepper very lightly.  Fold over parchment paper into half circles and roll and crimp edges tightly.  Bake packets at 400 degrees for 10-15 minutes, depending on thickness of the filets.', 
   'Serve the salmon in the parchment packets. A salad and boiled new potatoes, buttered and sprinkled with fresh parsley, are the perfect complements.');
INSERT INTO Recipes
  VALUES (15, 'Coupe Colonel', 6, 'For each person, place 2 scoops of lemon sorbet in a stemmed glass.  Top with vodka.', 
   'This is a lovely, light, and refreshing dessert.  Use the best sorbet and vodka you can find.  Serve with crisp cookies.');
 
INSERT INTO Ingredients
  VALUES (1, 'Beef', 2, 1);
INSERT INTO Ingredients
  VALUES (2, 'Onion', 3, 17);
INSERT INTO Ingredients
  VALUES (3, 'Water', 9, 1);
INSERT INTO Ingredients
  VALUES (4, 'Guinness Beer', 9, 1);
INSERT INTO Ingredients
  VALUES (5, 'Potato', 3, 2);
INSERT INTO Ingredients
  VALUES (6, 'Carrot', 3, 2);
INSERT INTO Ingredients
  VALUES (7, 'Tomato', 3, 8);
INSERT INTO Ingredients
  VALUES (8, 'Jalapeno', 3, 2);
INSERT INTO Ingredients
  VALUES (9, 'Garlic', 1, 16);
INSERT INTO Ingredients
  VALUES (10, 'Black Pepper (ground)', 1, 3);
INSERT INTO Ingredients
  VALUES (11, 'Salt', 1, 3);
INSERT INTO Ingredients
  VALUES (12, 'Halibut', 10, 5);
INSERT INTO Ingredients
  VALUES (13, 'Chicken, Fryer', 2, 5);
INSERT INTO Ingredients
  VALUES (14, 'Bacon', 2, 8);
INSERT INTO Ingredients
  VALUES (15, 'Romaine Lettuce', 3, 13);
INSERT INTO Ingredients
  VALUES (16, 'Iceberg Lettuce', 3, 13);
INSERT INTO Ingredients
  VALUES (17, 'Butterhead Lettuce', 3, 13);
INSERT INTO Ingredients
  VALUES (18, 'Scallop', 10, 5);
INSERT INTO Ingredients
  VALUES (19, 'Salmon', 10, 5);
INSERT INTO Ingredients
  VALUES (20, 'Vinegar', 9, 1);
INSERT INTO Ingredients
  VALUES (21, 'Olive Oil', 4, 1);
INSERT INTO Ingredients
  VALUES (22, 'Cucumber', 3, 17);
INSERT INTO Ingredients
  VALUES (23, 'Mushrooms', 3, 2);
INSERT INTO Ingredients
  VALUES (24, 'Red Wine', 9, 2);
INSERT INTO Ingredients
  VALUES (25, 'White Wine', 9, 2);
INSERT INTO Ingredients
  VALUES (26, 'Milk', 8, 2);
INSERT INTO Ingredients
  VALUES (27, 'Cheddar Cheese', 12, 2);
INSERT INTO Ingredients
  VALUES (28, 'Tortilla Chips', 18, 11);
INSERT INTO Ingredients
  VALUES (29, 'Black Olives', 19, 2);
INSERT INTO Ingredients
  VALUES (30, 'Green Beans', 3, 14);
INSERT INTO Ingredients
  VALUES (31, 'Fettuccini Pasta', 5, 1);
INSERT INTO Ingredients
  VALUES (32, 'Heavy Cream', 8, 1);
INSERT INTO Ingredients
  VALUES (33, 'Chicken, Pre-cut', 2, 17);
INSERT INTO Ingredients
  VALUES (34, 'T-bone Steak', 2, 17);
INSERT INTO Ingredients
  VALUES (35, 'Chicken Breast', 2, 7);
INSERT INTO Ingredients
  VALUES (36, 'Chicken Leg', 2, 17);
INSERT INTO Ingredients
  VALUES (37, 'Chicken Wing', 2, 7);
INSERT INTO Ingredients
  VALUES (38, 'Chicken Thigh', 2, 7);
INSERT INTO Ingredients
  VALUES (39, 'New York Steak', 2, 17);
INSERT INTO Ingredients
  VALUES (40, 'Spaghetti', 5, 1);
INSERT INTO Ingredients
  VALUES (41, 'Mustard, Regular', 19, 1);
INSERT INTO Ingredients
  VALUES (42, 'Mustard, Dijon', 19, 1);
INSERT INTO Ingredients
  VALUES (43, 'Ketchup', 19, 1);
INSERT INTO Ingredients
  VALUES (44, 'Salsa', 13, 1);
INSERT INTO Ingredients
  VALUES (45, 'Parmesan Cheese', 12, 1);
INSERT INTO Ingredients
  VALUES (46, 'Blue Cheese', 12, 1);
INSERT INTO Ingredients
  VALUES (47, 'Butter', 11, 4);
INSERT INTO Ingredients
  VALUES (48, 'Green Onion', 3, 14);
INSERT INTO Ingredients
  VALUES (49, 'Green Olives', 19, 2);
INSERT INTO Ingredients
  VALUES (50, 'Vegetable Oil', 4, 4);
INSERT INTO Ingredients
  VALUES (51, 'White Pepper (ground)', 1, 1);
INSERT INTO Ingredients
  VALUES (52, 'Cayenne Pepper, Ground', 1, 1);
INSERT INTO Ingredients
  VALUES (53, 'Radishes', 3, 14);
INSERT INTO Ingredients
  VALUES (54, 'Balsamic Vinaigrette Dressing', 20, 
   1);
INSERT INTO Ingredients
  VALUES (55, 'Sponge Cake', 21, 20);
INSERT INTO Ingredients
  VALUES (56, 'Raspberry Jello', 21, 20);
INSERT INTO Ingredients
  VALUES (57, 'Bird''s Custard Powder', 21, 20);
INSERT INTO Ingredients
  VALUES (58, 'Colored sugar sprinkles', 1, 3);
INSERT INTO Ingredients
  VALUES (59, 'Raspberry Jam', 21, 21);
INSERT INTO Ingredients
  VALUES (61, 'Flour', 6, 2);
INSERT INTO Ingredients
  VALUES (62, 'Eggs', 8, 7);
INSERT INTO Ingredients
  VALUES (63, 'Beef drippings', 4, 3);
INSERT INTO Ingredients
  VALUES (64, 'Red Snapper', 10, 1);
INSERT INTO Ingredients
  VALUES (65, 'Canned tomatoes', 3, 10);
INSERT INTO Ingredients
  VALUES (66, 'Nutmeg', 1, 3);
INSERT INTO Ingredients
  VALUES (67, 'Cinnamon', 1, 3);
INSERT INTO Ingredients
  VALUES (68, 'Lime Juice', 9, 3);
INSERT INTO Ingredients
  VALUES (69, 'Asparagus', 3, 5);
INSERT INTO Ingredients
  VALUES (70, 'Parsley', 22, 22);
INSERT INTO Ingredients
  VALUES (71, 'Pie dough for 2-crust pie', 21, 24);
INSERT INTO Ingredients
  VALUES (72, 'Ground Pork', 2, 5);
INSERT INTO Ingredients
  VALUES (73, 'Ground Clove', 1, 3);
INSERT INTO Ingredients
  VALUES (74, 'Bread Crumbs', 21, 2);
INSERT INTO Ingredients
  VALUES (75, 'Leek', 3, 7);
INSERT INTO Ingredients
  VALUES (76, 'Red Bell Pepper', 3, 7);
INSERT INTO Ingredients
  VALUES (77, 'Lemon Juice', 9, 4);
INSERT INTO Ingredients
  VALUES (78, 'Lemon ', 17, 7);
INSERT INTO Ingredients
  VALUES (79, 'Lemon Sorbet', 23, 26);
INSERT INTO Ingredients
  VALUES (80, 'Vodka', 24, 4);
 
INSERT INTO Recipe_Ingredients
  VALUES (1, 1, 1, 5, 1);
INSERT INTO Recipe_Ingredients
  VALUES (1, 2, 2, 17, 2);
INSERT INTO Recipe_Ingredients
  VALUES (1, 3, 5, 17, 4);
INSERT INTO Recipe_Ingredients
  VALUES (1, 4, 6, 17, 6);
INSERT INTO Recipe_Ingredients
  VALUES (1, 5, 3, 23, 4);
INSERT INTO Recipe_Ingredients
  VALUES (1, 6, 4, 1, 12);
INSERT INTO Recipe_Ingredients
  VALUES (2, 1, 8, 17, 6);
INSERT INTO Recipe_Ingredients
  VALUES (2, 2, 7, 17, 2);
INSERT INTO Recipe_Ingredients
  VALUES (2, 3, 2, 17, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (2, 4, 10, 4, 1);
INSERT INTO Recipe_Ingredients
  VALUES (2, 5, 11, 3, 1);
INSERT INTO Recipe_Ingredients
  VALUES (3, 1, 8, 17, 4);
INSERT INTO Recipe_Ingredients
  VALUES (3, 2, 27, 2, 1);
INSERT INTO Recipe_Ingredients
  VALUES (3, 3, 2, 17, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (3, 4, 28, 11, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (3, 5, 29, 2, 0.25);
INSERT INTO Recipe_Ingredients
  VALUES (4, 1, 30, 5, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (4, 2, 9, 16, 2);
INSERT INTO Recipe_Ingredients
  VALUES (4, 3, 21, 4, 1);
INSERT INTO Recipe_Ingredients
  VALUES (5, 1, 31, 1, 16);
INSERT INTO Recipe_Ingredients
  VALUES (5, 2, 50, 4, 1);
INSERT INTO Recipe_Ingredients
  VALUES (5, 3, 11, 3, 3);
INSERT INTO Recipe_Ingredients
  VALUES (5, 4, 47, 4, 6);
INSERT INTO Recipe_Ingredients
  VALUES (5, 5, 32, 2, 0.25);
INSERT INTO Recipe_Ingredients
  VALUES (5, 12, 45, 1, 6);
INSERT INTO Recipe_Ingredients
  VALUES (5, 16, 51, 19, 0);
INSERT INTO Recipe_Ingredients
  VALUES (6, 1, 36, 7, 2);
INSERT INTO Recipe_Ingredients
  VALUES (6, 2, 38, 7, 2);
INSERT INTO Recipe_Ingredients
  VALUES (6, 3, 11, 3, 1.5);
INSERT INTO Recipe_Ingredients
  VALUES (6, 4, 10, 3, 1.5);
INSERT INTO Recipe_Ingredients
  VALUES (6, 5, 9, 16, 3);
INSERT INTO Recipe_Ingredients
  VALUES (6, 6, 52, 19, 0);
INSERT INTO Recipe_Ingredients
  VALUES (7, 1, 15, 13, 1);
INSERT INTO Recipe_Ingredients
  VALUES (7, 2, 23, 7, 12);
INSERT INTO Recipe_Ingredients
  VALUES (7, 3, 22, 17, 1);
INSERT INTO Recipe_Ingredients
  VALUES (7, 4, 7, 17, 1);
INSERT INTO Recipe_Ingredients
  VALUES (7, 5, 53, 14, 1);
INSERT INTO Recipe_Ingredients
  VALUES (7, 6, 54, 4, 3);
INSERT INTO Recipe_Ingredients
  VALUES (8, 1, 55, 20, 1);
INSERT INTO Recipe_Ingredients
  VALUES (8, 2, 56, 20, 1);
INSERT INTO Recipe_Ingredients
  VALUES (8, 3, 57, 20, 1);
INSERT INTO Recipe_Ingredients
  VALUES (8, 4, 59, 21, 1);
INSERT INTO Recipe_Ingredients
  VALUES (8, 5, 58, 3, 1);
INSERT INTO Recipe_Ingredients
  VALUES (9, 1, 1, 5, 4);
INSERT INTO Recipe_Ingredients
  VALUES (9, 2, 9, 16, 6);
INSERT INTO Recipe_Ingredients
  VALUES (9, 3, 11, 3, 1);
INSERT INTO Recipe_Ingredients
  VALUES (9, 4, 10, 3, 1);
INSERT INTO Recipe_Ingredients
  VALUES (10, 1, 61, 2, 1.5);
INSERT INTO Recipe_Ingredients
  VALUES (10, 2, 3, 2, 1);
INSERT INTO Recipe_Ingredients
  VALUES (10, 3, 62, 7, 2);
INSERT INTO Recipe_Ingredients
  VALUES (10, 4, 11, 3, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (10, 5, 26, 2, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (10, 6, 63, 3, 4);
INSERT INTO Recipe_Ingredients
  VALUES (11, 1, 64, 5, 2);
INSERT INTO Recipe_Ingredients
  VALUES (11, 2, 21, 1, 4);
INSERT INTO Recipe_Ingredients
  VALUES (11, 3, 2, 17, 1);
INSERT INTO Recipe_Ingredients
  VALUES (11, 4, 65, 10, 2);
INSERT INTO Recipe_Ingredients
  VALUES (11, 5, 11, 3, 1);
INSERT INTO Recipe_Ingredients
  VALUES (11, 6, 10, 3, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (11, 7, 66, 3, 0.25);
INSERT INTO Recipe_Ingredients
  VALUES (11, 8, 67, 3, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (11, 9, 68, 3, 2);
INSERT INTO Recipe_Ingredients
  VALUES (11, 10, 49, 7, 8);
INSERT INTO Recipe_Ingredients
  VALUES (11, 11, 61, 2, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (11, 12, 70, 22, 2);
INSERT INTO Recipe_Ingredients
  VALUES (12, 1, 69, 5, 1);
INSERT INTO Recipe_Ingredients
  VALUES (12, 2, 47, 4, 4);
INSERT INTO Recipe_Ingredients
  VALUES (12, 3, 9, 16, 4);
INSERT INTO Recipe_Ingredients
  VALUES (13, 1, 71, 24, 2);
INSERT INTO Recipe_Ingredients
  VALUES (13, 2, 72, 5, 2);
INSERT INTO Recipe_Ingredients
  VALUES (13, 3, 2, 2, 0.333);
INSERT INTO Recipe_Ingredients
  VALUES (13, 4, 67, 4, 1);
INSERT INTO Recipe_Ingredients
  VALUES (13, 5, 73, 3, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (13, 6, 11, 3, 0.25);
INSERT INTO Recipe_Ingredients
  VALUES (13, 7, 10, 3, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (13, 8, 74, 2, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (14, 1, 19, 25, 4);
INSERT INTO Recipe_Ingredients
  VALUES (14, 2, 6, 7, 2);
INSERT INTO Recipe_Ingredients
  VALUES (14, 3, 75, 7, 1);
INSERT INTO Recipe_Ingredients
  VALUES (14, 4, 76, 7, 1);
INSERT INTO Recipe_Ingredients
  VALUES (14, 5, 47, 4, 4);
INSERT INTO Recipe_Ingredients
  VALUES (14, 6, 25, 4, 2);
INSERT INTO Recipe_Ingredients
  VALUES (14, 7, 77, 4, 2);
INSERT INTO Recipe_Ingredients
  VALUES (14, 8, 78, 7, 1);
INSERT INTO Recipe_Ingredients
  VALUES (14, 9, 11, 3, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (14, 10, 10, 3, 0.5);
INSERT INTO Recipe_Ingredients
  VALUES (15, 1, 79, 26, 2);
INSERT INTO Recipe_Ingredients
  VALUES (15, 2, 80, 4, 2);
GO 


USE RecipesExample;
GO

CREATE VIEW CH04_Complete_Ingredient_List
AS
SELECT     IngredientName
FROM         Ingredients;
GO

CREATE VIEW CH04_Main_Recipe_Information
AS
SELECT     TOP 100 PERCENT Recipes.*
FROM         Recipes
ORDER BY RecipeTitle;
GO

CREATE VIEW CH04_Recipe_Class_IDs
AS
SELECT DISTINCT RecipeClassID
FROM         Recipes;
GO

CREATE VIEW CH04_Recipe_Classes_And_Titles
AS
SELECT     TOP 100 PERCENT RecipeClassID, RecipeTitle
FROM         Recipes
ORDER BY RecipeClassID, RecipeTitle;
GO

CREATE VIEW CH06_First_5_Recipes
AS
SELECT     RecipeID, RecipeTitle, Preparation, Notes
FROM         Recipes
WHERE     (RecipeID BETWEEN 1 AND 5);
GO

CREATE VIEW CH06_Main_Courses_With_Notes
AS
SELECT     RecipeTitle, Preparation, Notes
FROM         Recipes
WHERE     (RecipeClassID = 1) AND (Notes IS NOT NULL);
GO

CREATE VIEW CH06_Meats_That_Are_Not_Chicken
AS
SELECT     IngredientName
FROM         Ingredients
WHERE     (IngredientName NOT LIKE '%CHICKEN%') AND (IngredientClassID = 2);
GO

CREATE VIEW CH06_Recipes_With_No_Notes
AS
SELECT     RecipeTitle
FROM         Recipes
WHERE     (Notes IS NULL);
GO

CREATE VIEW CH08_Beef_And_Garlic_Recipes
AS
SELECT     BeefRecipes.RecipeTitle
FROM         (SELECT     Recipes.RecipeID, Recipes.RecipeTitle
                       FROM          (Recipes INNER JOIN
                                              Recipe_Ingredients ON Recipes.RecipeID = Recipe_Ingredients.RecipeID) INNER JOIN
                                              Ingredients ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID
                       WHERE      Ingredients.IngredientName = 'Beef') BeefRecipes INNER JOIN
                          (SELECT     Recipe_Ingredients.RecipeID
                            FROM          Recipe_Ingredients INNER JOIN
                                                   Ingredients ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID
                            WHERE      Ingredients.IngredientName = 'Garlic') GarlicRecipes ON BeefRecipes.RecipeID = GarlicRecipes.RecipeID;
GO

CREATE VIEW CH08_Beef_Or_Garlic_Recipes
AS
SELECT DISTINCT Recipes.RecipeTitle
FROM         Recipes INNER JOIN
                      Recipe_Ingredients ON Recipes.RecipeID = Recipe_Ingredients.RecipeID
WHERE     (Recipe_Ingredients.IngredientID IN (1, 9));
GO

CREATE VIEW CH08_Ingredients_Same_Measure
AS
SELECT     First_Ingredient.FirstIngredientName, First_Ingredient.MeasurementDescription, Second_Ingredient.SecondIngredientName
FROM         (SELECT     Ingredients.IngredientName AS FirstIngredientName, Measurements.MeasurementDescription
                       FROM          Ingredients INNER JOIN
                                              Measurements ON Ingredients.MeasureAmountID = Measurements.MeasureAmountID) First_Ingredient INNER JOIN
                          (SELECT     Ingredients.IngredientName AS SecondIngredientName, Measurements.MeasurementDescription
                            FROM          Ingredients INNER JOIN
                                                   Measurements ON Ingredients.MeasureAmountID = Measurements.MeasureAmountID) Second_Ingredient ON 
                      First_Ingredient.FirstIngredientName <> Second_Ingredient.SecondIngredientName AND 
                      First_Ingredient.MeasurementDescription = Second_Ingredient.MeasurementDescription;
GO

CREATE VIEW CH08_Main_Course_Ingredients
AS
SELECT     Recipes.RecipeTitle, Ingredients.IngredientName, Measurements.MeasurementDescription, Recipe_Ingredients.Amount
FROM         Recipe_Classes INNER JOIN
                      Recipes ON Recipes.RecipeClassID = Recipe_Classes.RecipeClassID INNER JOIN
                      Recipe_Ingredients ON Recipes.RecipeID = Recipe_Ingredients.RecipeID INNER JOIN
                      Ingredients ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID INNER JOIN
                      Measurements ON Measurements.MeasureAmountID = Recipe_Ingredients.MeasureAmountID
WHERE     (Recipe_Classes.RecipeClassDescription = 'Main course');
GO

CREATE VIEW CH08_Recipes_Containing_Carrots
AS
SELECT     Recipes.RecipeID, Recipes.RecipeTitle, Ingredients.IngredientName
FROM         Recipes INNER JOIN
                      Recipe_Ingredients ON Recipes.RecipeID = Recipe_Ingredients.RecipeID INNER JOIN
                      Ingredients ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID INNER JOIN
                          (SELECT     Recipe_Ingredients.RecipeID
                            FROM          Ingredients INNER JOIN
                                                   Recipe_Ingredients ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID
                            WHERE      Ingredients.IngredientName = 'Carrot') Carrots ON Recipes.RecipeID = Carrots.RecipeID;
GO

CREATE VIEW CH08_Recipes_Containing_Dairy
AS
SELECT DISTINCT Recipes.RecipeTitle
FROM         Recipes INNER JOIN
                      Recipe_Ingredients ON Recipes.RecipeID = Recipe_Ingredients.RecipeID INNER JOIN
                      Ingredients ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID INNER JOIN
                      Ingredient_Classes ON Ingredient_Classes.IngredientClassID = Ingredients.IngredientClassID
WHERE     (Ingredient_Classes.IngredientClassDescription = 'Dairy');
GO

CREATE VIEW CH08_Salads
AS
SELECT     Recipes.RecipeTitle
FROM         Recipes INNER JOIN
                      Recipe_Classes ON Recipes.RecipeClassID = Recipe_Classes.RecipeClassID
WHERE     (Recipe_Classes.RecipeClassDescription = 'Salad');
GO

CREATE VIEW CH09_All_Ingredients_Any_Recipes
AS
SELECT     Ingredients.IngredientName, R.RecipeID, R.RecipeTitle
FROM         Ingredients LEFT OUTER JOIN
                          (SELECT DISTINCT Recipes.RecipeID, Recipes.RecipeTitle, Recipe_Ingredients.IngredientID
                            FROM          Recipes INNER JOIN
                                                   Recipe_Ingredients ON Recipes.RecipeID = Recipe_Ingredients.RecipeID) R ON Ingredients.IngredientID = R.IngredientID;
GO

CREATE VIEW CH09_All_Recipe_Classes_All_Recipes
AS
SELECT     TOP (100) PERCENT Recipe_Classes.RecipeClassDescription, Recipes.RecipeTitle, Ingredients.IngredientName, Recipe_Ingredients.RecipeSeqNo, 
                 Recipe_Ingredients.Amount, Measurements.MeasurementDescription
FROM       Recipes LEFT OUTER JOIN Recipe_Ingredients 
              ON Recipes.RecipeID = Recipe_Ingredients.RecipeID 
           INNER JOIN Measurements 
              ON Measurements.MeasureAmountID = Recipe_Ingredients.MeasureAmountID 
           FULL OUTER JOIN Ingredients 
              ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID 
           FULL OUTER JOIN Recipe_Classes 
              ON Recipes.RecipeClassID = Recipe_Classes.RecipeClassID
ORDER BY Recipe_Classes.RecipeClassDescription DESC, Recipes.RecipeTitle, Recipe_Ingredients.RecipeSeqNo;
GO

CREATE VIEW CH09_All_RecipeClasses_And_Matching_Recipes
AS
SELECT     Recipe_Classes.RecipeClassDescription, Recipes.RecipeTitle
FROM         Recipe_Classes LEFT OUTER JOIN
                      Recipes ON Recipe_Classes.RecipeClassID = Recipes.RecipeClassID;
GO

CREATE VIEW CH09_Ingredients_Not_Used
AS
SELECT     Ingredients.IngredientName
FROM         Ingredients LEFT OUTER JOIN
                      Recipe_Ingredients ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID
WHERE     (Recipe_Ingredients.RecipeID IS NULL);
GO

CREATE VIEW CH09_Recipe_Classes_No_Recipes
AS
SELECT     Recipe_Classes.RecipeClassDescription
FROM         Recipe_Classes LEFT OUTER JOIN
                      Recipes ON Recipe_Classes.RecipeClassID = Recipes.RecipeClassID
WHERE     (Recipes.RecipeID IS NULL);
GO

CREATE VIEW CH09_Salad_Soup_Main_Courses
AS
SELECT     RCFiltered.ClassName, R.RecipeTitle
FROM         (SELECT     RC.RecipeClassID, RC.RecipeClassDescription AS ClassName
                       FROM          Recipe_Classes AS RC
                       WHERE      RC.RecipeClassDescription = 'Salad' OR
                                              RC.RecipeClassDescription = 'Soup' OR
                                              RC.RecipeClassDescription = 'Main course') RCFiltered LEFT OUTER JOIN
                      Recipes R ON RCFiltered.RecipeClassID = R.RecipeClassID;
GO

CREATE VIEW CH10_Classes_Recipes_Ingredients
AS
SELECT     Recipe_Classes.RecipeClassDescription AS IndexName, 'Recipe Class' AS Type
FROM         Recipe_Classes
UNION
SELECT     Recipes.RecipeTitle, 'Recipe' AS Type
FROM         Recipes
UNION
SELECT     Ingredients.IngredientName, 'Ingredient' AS Type
FROM         Ingredients;
GO

CREATE VIEW CH10_Ingredient_Recipe_Measurements
AS
SELECT     Ingredients.IngredientName, Measurements.MeasurementDescription, 'Ingredient' AS Type
FROM         Measurements INNER JOIN
                      Ingredients ON (Measurements.MeasureAmountID = Ingredients.MeasureAmountID)
UNION
SELECT     Ingredients.IngredientName, Measurements.MeasurementDescription, 'Recipe' AS Type
FROM         (Measurements INNER JOIN
                      Recipe_Ingredients ON (Measurements.MeasureAmountID = Recipe_Ingredients.MeasureAmountID)) INNER JOIN
                      Ingredients ON (Ingredients.IngredientID = Recipe_Ingredients.IngredientID);
GO

CREATE VIEW CH11_Count_Of_Recipe_Types
AS
SELECT     RecipeClassID, RecipeClassDescription,
                          (SELECT     COUNT(*)
                            FROM          Recipes
                            WHERE      Recipes.RecipeClassID = Recipe_Classes.RecipeClassID) AS RecipeCount
FROM         Recipe_Classes;
GO

CREATE VIEW CH11_Ingredients_Using_NonStandard_Measure
AS
SELECT     IngredientID, IngredientName, MeasureAmountID
FROM         Ingredients
WHERE     (MeasureAmountID <> ANY
                          (SELECT     Recipe_Ingredients.MeasureAmountID
                            FROM          Recipe_Ingredients
                            WHERE      Recipe_Ingredients.IngredientID = Ingredients.IngredientID));
GO

CREATE VIEW CH11_Meat_Ingredient_Recipe_Count
AS
SELECT     Ingredient_Classes.IngredientClassDescription, Ingredients.IngredientName,
                          (SELECT     COUNT(*)
                            FROM          Recipe_Ingredients
                            WHERE      Recipe_Ingredients.IngredientID = Ingredients.IngredientID) AS RecipeCount
FROM         Ingredient_Classes INNER JOIN
                      Ingredients ON Ingredient_Classes.IngredientClassID = Ingredients.IngredientClassID
WHERE     (Ingredient_Classes.IngredientClassDescription = 'Meat');
GO

CREATE VIEW CH11_Recipes_Ingredients_With_Carrots
AS
SELECT     Recipes.RecipeTitle, Ingredients.IngredientName
FROM         Recipes INNER JOIN
                      Recipe_Ingredients ON Recipes.RecipeID = Recipe_Ingredients.RecipeID INNER JOIN
                      Ingredients ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID
WHERE     (Recipes.RecipeID IN
                          (SELECT     Recipe_Ingredients.RecipeID
                            FROM          Ingredients INNER JOIN
                                                   Recipe_Ingredients ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID
                            WHERE      Ingredients.IngredientName = 'Carrot'));
GO

CREATE VIEW CH12_Number_of_Ingredients_Measured_by_the_Cup
AS
SELECT     COUNT(*) AS NumberOfIngredients
FROM         Ingredients INNER JOIN
                      Measurements ON Ingredients.MeasureAmountID = Measurements.MeasureAmountID
WHERE     (Measurements.MeasurementDescription = 'Cup');
GO

CREATE VIEW CH12_Number_Of_Main_Course_Recipes
AS
SELECT DISTINCT COUNT(*) AS NumberOfRecipes
FROM         Recipes INNER JOIN
                      Recipe_Classes ON Recipes.RecipeClassID = Recipe_Classes.RecipeClassID
WHERE     (Recipe_Classes.RecipeClassDescription = 'Main course');
GO

CREATE VIEW CH12_Recipe_With_Most_Cloves_of_Garlic
AS
SELECT DISTINCT Recipes.RecipeTitle
FROM         Recipes INNER JOIN
                      Recipe_Ingredients ON Recipes.RecipeID = Recipe_Ingredients.RecipeID INNER JOIN
                      Ingredients ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID
WHERE     (Ingredients.IngredientName = 'Garlic') AND (Recipe_Ingredients.Amount =
                          (SELECT     MAX(Amount)
                            FROM          Recipe_Ingredients INNER JOIN
                                                   Ingredients ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID
                            WHERE      IngredientName = 'Garlic'));
GO

CREATE VIEW CH12_Recipes_With_Beef_Ingredient
AS
SELECT     COUNT(*) AS NumberOfRecipes
FROM         Recipes
WHERE     (RecipeID IN
                          (SELECT     RecipeID
                            FROM          Recipe_Ingredients INNER JOIN
                                                   Ingredients ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID
                            WHERE      IngredientName LIKE 'Beef%'));
GO

CREATE VIEW CH12_Total_Salt_Used
AS
SELECT     SUM(Recipe_Ingredients.Amount) AS TotalTeaspoons
FROM         Recipe_Ingredients INNER JOIN
                      Ingredients ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID
WHERE     (Ingredients.IngredientName = 'Salt');
GO

CREATE VIEW CH13_IngredientClass_Distinct_Recipe_Count
AS
SELECT     Ingredient_Classes.IngredientClassDescription, COUNT(DISTINCT Recipe_Ingredients.RecipeID) AS CountOfRecipeID
FROM         Ingredient_Classes INNER JOIN
                      Ingredients ON Ingredient_Classes.IngredientClassID = Ingredients.IngredientClassID INNER JOIN
                      Recipe_Ingredients ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID
GROUP BY Ingredient_Classes.IngredientClassDescription;
GO

CREATE VIEW CH13_Meat_Ingredient_Recipe_Count_Group
AS
SELECT     Ingredient_Classes.IngredientClassDescription, Ingredients.IngredientName, COUNT(*) AS RecipeCount
FROM         Ingredient_Classes INNER JOIN
                      Ingredients ON Ingredient_Classes.IngredientClassID = Ingredients.IngredientClassID INNER JOIN
                      Recipe_Ingredients ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID
WHERE     (Ingredient_Classes.IngredientClassDescription = 'Meat')
GROUP BY Ingredient_Classes.IngredientClassDescription, Ingredients.IngredientName;
GO

CREATE VIEW CH13_Meat_Ingredient_Recipe_Count_Subquery
AS
SELECT     Ingredient_Classes.IngredientClassDescription, Ingredients.IngredientName,
                          (SELECT     COUNT(*)
                            FROM          Recipe_Ingredients
                            WHERE      Recipe_Ingredients.IngredientID = Ingredients.IngredientID) AS RecipeCount
FROM         Ingredient_Classes INNER JOIN
                      Ingredients ON Ingredient_Classes.IngredientClassID = Ingredients.IngredientClassID
WHERE     (Ingredient_Classes.IngredientClassDescription = 'Meat');
GO

CREATE VIEW CH13_Total_Ingredients_Needed
AS
SELECT     Ingredients.IngredientName, Measurements.MeasurementDescription, SUM(Recipe_Ingredients.Amount) AS SumOfAmount
FROM         Ingredients INNER JOIN
                      Measurements INNER JOIN
                      Recipe_Ingredients ON Measurements.MeasureAmountID = Recipe_Ingredients.MeasureAmountID ON 
                      Ingredients.IngredientID = Recipe_Ingredients.IngredientID
GROUP BY Ingredients.IngredientName, Measurements.MeasurementDescription;
GO

CREATE VIEW CH14_Recipe_Classes_Lots_Of_Salt
AS
SELECT Recipe_Classes.RecipeClassDescription, Ingredients.IngredientName, Sum(Recipe_Ingredients.Amount) AS SumOfSaltTeaspoons
FROM (((Recipe_Classes INNER JOIN Recipes 
ON Recipe_Classes.RecipeClassID=Recipes.RecipeClassID) 
INNER JOIN Recipe_Ingredients 
ON Recipes.RecipeID=Recipe_Ingredients.RecipeID) 
INNER JOIN Ingredients 
ON Ingredients.IngredientID=Recipe_Ingredients.IngredientID) 
INNER JOIN Measurements 
ON Measurements.MeasureAmountID=Recipe_Ingredients.MeasureAmountID
WHERE Ingredients.IngredientName='salt' 
   And Measurements.MeasurementDescription='Teaspoon'
GROUP BY Recipe_Classes.RecipeClassDescription, Ingredients.IngredientName
HAVING Sum(Recipe_Ingredients.Amount)>3;
GO

CREATE VIEW CH14_Recipe_Classes_Two_Or_More
AS
SELECT     Recipe_Classes.RecipeClassDescription, COUNT(Recipes.RecipeID) AS CountOfRecipeID
FROM         Recipe_Classes INNER JOIN
                      Recipes ON Recipe_Classes.RecipeClassID = Recipes.RecipeClassID
GROUP BY Recipe_Classes.RecipeClassDescription
HAVING      (COUNT(Recipes.RecipeID) >= 2);
GO

CREATE VIEW CH14_Recipes_Beef_And_Garlic
AS
SELECT     RecipeTitle
FROM         Recipes
WHERE     (RecipeID IN
                          (SELECT     Recipe_Ingredients.RecipeID
                            FROM          Ingredients INNER JOIN
                                                   Recipe_Ingredients ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID
                            WHERE      Ingredients.IngredientName = 'Beef' OR
                                                   Ingredients.IngredientName = 'Garlic'
                            GROUP BY Recipe_Ingredients.RecipeID
                            HAVING      COUNT(Recipe_Ingredients.RecipeID) = 2));
GO

CREATE VIEW CH18_Ingredients_No_Recipe
AS 
SELECT Ingredients.IngredientName
FROM Ingredients
WHERE Ingredients.IngredientID NOT IN 
(SELECT Recipe_Ingredients.IngredientID FROM Recipe_Ingredients);
GO

CREATE VIEW CH18_Ingredients_NOTIN_IrishStew_PolloPicoso_RoastBeef
AS 
SELECT Ingredients.IngredientID, Ingredients.IngredientName
FROM Ingredients
WHERE Ingredients.IngredientID NOT IN 
(SELECT Recipe_Ingredients.IngredientID 
FROM Recipe_Ingredients
INNER JOIN Recipes 
ON Recipe_Ingredients.RecipeID = Recipes.RecipeID 
WHERE RecipeTitle IN 
('Irish Stew', 'Pollo Picoso', 'Roast Beef'));
GO

CREATE VIEW CH18_Recipe_Classes_No_Recipes_NOT_IN
AS 
SELECT Recipe_Classes.RecipeClassDescription
FROM Recipe_Classes
WHERE Recipe_Classes.RecipeClassID NOT IN 
(SELECT Recipes.RecipeClassID 
FROM Recipes);
GO

CREATE VIEW CH18_Recipes_AtLeast_3_Same_Ingredients
AS 
SELECT Recipes.RecipeID, Recipes.RecipeTitle, R2.RecipeID AS R2ID, R2.RecipeTitle AS R2Title, Count(Recipe_Ingredients.RecipeID) AS CountOfRecipeID
FROM ((Recipes
INNER JOIN Recipe_Ingredients
ON Recipes.RecipeID=Recipe_Ingredients.RecipeID)
INNER JOIN Recipe_Ingredients AS RI2
ON Recipe_Ingredients.IngredientID=RI2.IngredientID)
INNER JOIN Recipes AS R2
ON R2.RecipeID=RI2.RecipeID
WHERE RI2.RecipeID>Recipes.RecipeID
GROUP BY Recipes.RecipeID, Recipes.RecipeTitle, R2.RecipeID, R2.RecipeTitle
HAVING Count(Recipe_Ingredients.RecipeID)>=3;
GO

CREATE VIEW CH18_Recipes_Beef_And_Garlic
AS 
SELECT Recipes.RecipeTitle, Recipes.Preparation
FROM Recipes
WHERE EXISTS 
(SELECT Recipe_Ingredients.*
FROM Ingredients
INNER JOIN Recipe_Ingredients
ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID
WHERE Ingredients.IngredientName='Beef'
AND Recipe_Ingredients.RecipeID = Recipes.RecipeID)
AND EXISTS 
(SELECT Recipe_Ingredients.*
FROM Ingredients
INNER JOIN Recipe_Ingredients
ON Ingredients.IngredientID = Recipe_Ingredients.IngredientID
WHERE Ingredients.IngredientName='Garlic'
AND Recipe_Ingredients.RecipeID = Recipes.RecipeID);
GO

CREATE VIEW CH18_Recipes_Beef_Onion_Carrot
AS 
SELECT Recipes.RecipeID, Recipes.RecipeTitle
FROM Recipes
WHERE Recipes.RecipeID IN 
(SELECT Recipe_Ingredients.RecipeID 
FROM Recipe_Ingredients
INNER JOIN Ingredients 
ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID 
WHERE Ingredients.IngredientName = 'Beef') 
AND Recipes.RecipeID IN 
(SELECT Recipe_Ingredients.RecipeID 
FROM Recipe_Ingredients
INNER JOIN Ingredients 
ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID 
WHERE Ingredients.IngredientName = 'Onion') 
AND Recipes.RecipeID IN 
(SELECT Recipe_Ingredients.RecipeID 
FROM Recipe_Ingredients
INNER JOIN Ingredients 
ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID 
WHERE Ingredients.IngredientName = 'Carrot');
GO

CREATE VIEW CH18_Recipes_Butter_NOT_Beef_Onion_Carrot_GROUPBY
AS 
SELECT Recipes.RecipeID, Recipes.RecipeTitle
FROM ((Recipes
INNER JOIN Recipe_Ingredients
ON Recipes.RecipeID=Recipe_Ingredients.RecipeID)
INNER JOIN Ingredients
ON Ingredients.IngredientID=Recipe_Ingredients.IngredientID) LEFT JOIN (SELECT Recipe_Ingredients.RecipeID FROM Recipe_Ingredients
INNER JOIN Ingredients
ON Ingredients.IngredientID=Recipe_Ingredients.IngredientID WHERE Ingredients.IngredientName In ('Beef','Onion','Carrot'))  AS RIBOC
ON Recipes.RecipeID=RIBOC.RecipeID
WHERE Ingredients.IngredientName='Butter'
AND RIBOC.RecipeID Is Null
GROUP BY Recipes.RecipeID, Recipes.RecipeTitle
HAVING COUNT(RIBOC.RecipeID)=0;
GO

CREATE VIEW CH18_Recipes_No_Dairy_RIGHT
AS 
SELECT Recipes.RecipeID, Recipes.RecipeTitle
FROM Recipes
WHERE Recipes.RecipeID NOT IN
(SELECT Recipe_Ingredients.RecipeID 
FROM (Recipe_Ingredients
INNER JOIN Ingredients
ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID) 
INNER JOIN Ingredient_Classes
ON Ingredient_Classes.IngredientClassID = Ingredients.IngredientClassID
WHERE Ingredient_Classes.IngredientClassDescription = 'Butter')
AND Recipes.RecipeID NOT IN
(SELECT Recipe_Ingredients.RecipeID 
FROM (Recipe_Ingredients
INNER JOIN Ingredients
ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID) 
INNER JOIN Ingredient_Classes
ON Ingredient_Classes.IngredientClassID = Ingredients.IngredientClassID
WHERE Ingredient_Classes.IngredientClassDescription = 'Cheese')
AND Recipes.RecipeID NOT IN
(SELECT Recipe_Ingredients.RecipeID 
FROM (Recipe_Ingredients
INNER JOIN Ingredients
ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID) 
INNER JOIN Ingredient_Classes
ON Ingredient_Classes.IngredientClassID = Ingredients.IngredientClassID
WHERE Ingredient_Classes.IngredientClassDescription = 'Dairy');
GO

CREATE VIEW CH18_Recipes_No_Dairy_WRONG
AS 
SELECT DISTINCT Recipes.RecipeID, Recipes.RecipeTitle
FROM ((Recipes
INNER JOIN Recipe_Ingredients
ON Recipes.RecipeID=Recipe_Ingredients.RecipeID)
INNER JOIN Ingredients
ON Ingredients.IngredientID=Recipe_Ingredients.IngredientID)
INNER JOIN Ingredient_Classes
ON Ingredient_Classes.IngredientClassID=Ingredients.IngredientClassID
WHERE Ingredient_Classes.IngredientClassDescription Not In ('Butter','Cheese','Dairy');
GO

CREATE VIEW CH18_Recipes_NOT_Beef_Onion_Carrot_GROUPBY
AS 
SELECT Recipes.RecipeID, Recipes.RecipeTitle
FROM Recipes LEFT JOIN (SELECT Recipe_Ingredients.RecipeID 
FROM Recipe_Ingredients 
INNER JOIN Ingredients 
ON Ingredients.IngredientID=Recipe_Ingredients.IngredientID 
WHERE Ingredients.IngredientName In ('Beef','Onion','Carrot'))  AS RIBOC
ON Recipes.RecipeID=RIBOC.RecipeID
WHERE RIBOC.RecipeID IS NULL
GROUP BY Recipes.RecipeID, Recipes.RecipeTitle
HAVING COUNT(RIBOC.RecipeID)=0;
GO

CREATE VIEW CH18_Recipes_NOT_Beef_Onion_Carrot_NOTEXISTS
AS 
SELECT Recipes.RecipeID, Recipes.RecipeTitle
FROM Recipes
WHERE NOT EXISTS  
(SELECT * FROM Recipe_Ingredients 
INNER JOIN Ingredients 
ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID 
WHERE Ingredients.IngredientName IN ('Beef', 'Onion', 'Carrot') 
AND Recipe_Ingredients.RecipeID = Recipes.RecipeID);
GO

CREATE VIEW CH18_Recipes_NOT_Beef_Onion_Carrot_NOTIN_1
AS 
SELECT Recipes.RecipeID, Recipes.RecipeTitle
FROM Recipes
WHERE Recipes.RecipeID NOT IN 
(SELECT Recipe_Ingredients.RecipeID 
FROM Recipe_Ingredients
INNER JOIN Ingredients 
ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID 
WHERE Ingredients.IngredientName = 'Beef') 
AND Recipes.RecipeID NOT IN 
(SELECT Recipe_Ingredients.RecipeID 
FROM Recipe_Ingredients
INNER JOIN Ingredients 
ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID 
WHERE Ingredients.IngredientName = 'Onion') 
AND Recipes.RecipeID NOT IN 
(SELECT Recipe_Ingredients.RecipeID 
FROM Recipe_Ingredients
INNER JOIN Ingredients 
ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID 
WHERE Ingredients.IngredientName = 'Carrot');
GO

CREATE VIEW CH18_Recipes_NOT_Beef_Onion_Carrot_NOTIN_2
AS 
SELECT Recipes.RecipeID, Recipes.RecipeTitle
FROM Recipes
WHERE Recipes.RecipeID NOT IN 
(SELECT Recipe_Ingredients.RecipeID 
FROM Recipe_Ingredients
INNER JOIN Ingredients 
ON Recipe_Ingredients.IngredientID = Ingredients.IngredientID 
WHERE Ingredients.IngredientName IN ('Beef', 'Onion', 'Carrot'));
GO

CREATE VIEW CH18_Recipes_NOT_Beef_Onion_Carrot_OUTERJOIN
AS 
SELECT Recipes.RecipeID, Recipes.RecipeTitle
FROM Recipes LEFT JOIN (SELECT Recipe_Ingredients.RecipeID FROM Recipe_Ingredients
INNER JOIN Ingredients
ON Recipe_Ingredients.IngredientID=Ingredients.IngredientID WHERE Ingredients.IngredientName In ('Beef','Onion','Carrot'))  AS RBeefCarrotOnion
ON Recipes.RecipeID=RBeefCarrotOnion.RecipeID
WHERE RBeefCarrotOnion.RecipeID Is Null;
GO

